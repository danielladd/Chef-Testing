input {
  lumberjack {
    port => 2351
    ssl_certificate => "/opt/logstash/ssl/logstash.crt"
    ssl_key => "/opt/logstash/ssl/logstash.key"
  }
  syslog {
    type => missioncontrol
    port => 5544
  }
  tcp {
    port => 2352
    ssl_certificate => "/opt/logstash/ssl/logstash.crt"
    ssl_key => "/opt/logstash/ssl/logstash.key"
    codec => json { charset => "CP1252" }
    
  }
}

filter {
  <% @rules.each_with_index { |rule, index|  %>
#rule for <%= rule[0] %>
    <% if (index == 0) %>	
      if [@type] == "<%= rule[1][:name] %>" {
    <% else %>
      } else if [@type] == "<%= rule[1][:name] %>" {
    <% end %>
      <%= rule[1][:body] %>
    <% } %>
    } else {
# omega
#fallthrough catch-all.. need to put something here
    }
}

output {
  elasticsearch {
    cluster => "<%= @clustername %>"
    protocol => "node"
    host => "<%= @host %>"
  }
}
